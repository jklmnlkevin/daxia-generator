<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags" %>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
<%@ taglib prefix="sec" uri="http://www.springframework.org/security/tags" %> 

<c:set var="module" value="${model}"/>

<div class="pageContent">
	<form method="post" action="${'$'}{ctx }/admin/${'$'}{module }/save?id=${'$'}{n.id}&navTabId=${'$'}{param.navTabId}" class="pageForm required-validate" onsubmit="return validateCallback(this,navTabAjaxDone);">
		<div class="pageFormContent" layoutH="56">
			<#list mf.names as na>
			
			<#if na != 'id'>
			
			<#if mf.dateFormats[na_index] != ''>
				<p>
					<label>${mf.shortComments[na_index]}:</label>
					<input type="text" name="${na}" class="date" dateFmt="${mf.dateFormats[na_index]}" value="<fmt:formatDate value='${'$'}{n.${na} }' pattern='${mf.dateFormats[na_index]}'/>" size="30" readonly/>
				</p>
			<#elseif mf.isModel[na_index]>
				<p>
					<label>${mf.shortComments[na_index]}:</label>
					<input type="hidden" name="${na}.id" bringBackName="${na}.id" value="${'$'}{n.${na}.id }" size="30" />
					<input type="text" bringBackName="${na}.${mf.modelDisplayFields[na_index]}" value="${'$'}{n.${na}.${mf.modelDisplayFields[na_index]} }" size="30"  lookupGroup="${na}" readonly="readonly"/>
					<a class="btnLook" href="${'$'}{ctx }/admin/${na}/search?onlyFindType=0" lookupGroup="${na}"></a>
				</p>	
			<#else>
				<p>
					<label>${mf.shortComments[na_index]}:</label>
					<input type="text" name="${na}" value="${'$'}{n.${na} }" size="30" />
				</p>
			</#if>
			
			
			</#if>
			
			
			</#list>
		</div>
		<div class="formBar">
			<ul>
				<li>
					<c:if test="${'$'}{empty(${model}.id)}">
						<sec:authorize ifAnyGranted="${model}.add">
						<div class="buttonActive"><div class="buttonContent"><button type="submit">保存</button></div></div>
						</sec:authorize>
					</c:if>
					<c:if test="${'$'}{not empty(${model}.id)}">
						<sec:authorize ifAnyGranted="${model}.update">
						<div class="buttonActive"><div class="buttonContent"><button type="submit">保存</button></div></div>
						</sec:authorize>
					</c:if>
				</li>
				<li>
					<div class="button"><div class="buttonContent"><button type="button" class="close">取消</button></div></div>
				</li>
			</ul>
		</div>
	</form>
</div>
